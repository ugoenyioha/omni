# Stream configuration for TCP passthrough
# Add this to nginx.conf or as a separate stream block

stream {
    upstream omni_siderolink {
        server omni:8090;
    }
    
    server {
        listen 443;
        proxy_pass omni_siderolink;
        proxy_connect_timeout 1s;
        
        # SNI-based routing - pass through to Omni for omni-siderolink.home.usableapps.io
        ssl_preread on;
        proxy_protocol off;
    }
}

# Original HTTP/HTTPS configuration
# Remove the omni-siderolink.home.usableapps.io server block from here
# since it's now handled by the stream module

# ... rest of your existing nginx config for omni.home.usableapps.io ...